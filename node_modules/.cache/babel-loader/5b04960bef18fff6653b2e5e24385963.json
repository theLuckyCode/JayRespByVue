{"remainingRequest":"D:\\JayResp\\vuevhr\\node_modules\\babel-loader\\lib\\index.js!D:\\JayResp\\vuevhr\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\JayResp\\vuevhr\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\JayResp\\vuevhr\\src\\components\\sys\\basic\\PermissMana.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\JayResp\\vuevhr\\src\\components\\sys\\basic\\PermissMana.vue","mtime":1582246340727},{"path":"D:\\JayResp\\vuevhr\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JayResp\\vuevhr\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\JayResp\\vuevhr\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\JayResp\\vuevhr\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUGVybWlzc01hbmEiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICByb2xlOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgbmFtZVpoOiAnJwogICAgICB9LAogICAgICByb2xlczogW10sCiAgICAgIGFsbE1lbnVzOiBbXSwKICAgICAgc2VsZWN0ZWRNZW51czogW10sCiAgICAgIC8v5p2D6ZmQ57uE5omT5LqG5Yu+57uE5oiQ55qE5pWw57uECiAgICAgIGFjdGl2ZU5hbWU6IC0xLAogICAgICAvL+i/meS4quWAvOaYr+WkmuWwke+8jOmjjueQtOmdouadv+WwseaJk+W8gOWTquS4qu+8m+aJk+W8gOmjjueQtOmdouadv+aXtu+8jOmjjueQtOmdouadv+mHjOmdoueahOavj+S4gOS4qm5hbWXpg73kvJrnu5nku5botYvlgLwKICAgICAgZGVmYXVsdFByb3BzOiB7CiAgICAgICAgY2hpbGRyZW46ICdjaGlsZHJlbicsCiAgICAgICAgbGFiZWw6ICduYW1lJwogICAgICB9CiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdFJvbGVzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBkZWxldGVSb2xlOiBmdW5jdGlvbiBkZWxldGVSb2xlKHIpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOOAkCcgKyByLm5hbWVaaCArICfjgJHop5LoibIsIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuZGVsZXRlUmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzLz9pZD0iICsgci5pZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgICAgX3RoaXMuaW5pdFJvbGVzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRSb2xlOiBmdW5jdGlvbiBhZGRSb2xlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnJvbGUubmFtZSAmJiB0aGlzLnJvbGUubmFtZVpoKSB7CiAgICAgICAgdGhpcy5wb3N0UmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzL3JvbGUiLCB0aGlzLnJvbGUpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgIF90aGlzMi5yb2xlID0gewogICAgICAgICAgICAgIG5hbWU6ICcnLAogICAgICAgICAgICAgIG5hbWVaaDogJycKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIF90aGlzMi5pbml0Um9sZXMoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7fmjInop4TlrprovpPlhaXmiYDpnIDopoHnmoTlrZfmrrUhIik7CiAgICAgIH0KICAgIH0sCiAgICBjYW5jZWxVcGRhdGU6IGZ1bmN0aW9uIGNhbmNlbFVwZGF0ZSgpIHsKICAgICAgdGhpcy5hY3RpdmVOYW1lID0gLTE7CiAgICB9LAogICAgZG9VcGRhdGU6IGZ1bmN0aW9uIGRvVXBkYXRlKHJpZCwgaW5kZXgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB2YXIgdHJlZSA9IHRoaXMuJHJlZnMudHJlZVtpbmRleF07CiAgICAgIHZhciBzZWxlY3RlZEtleXMgPSB0cmVlLmdldENoZWNrZWRLZXlzKHRydWUpOyAvL2dldENoZWNrZWRLZXlz5pa55rOV55So5LqO6I635Y+W5b2T5YmN5qCR5b2i5o6n5Lu26YCJ5Lit55qEbm9kZS1rZXks5Lyg5YWldHJ1ZeeahOivne+8jOWNs+S7o+ihqOWPquS8muiOt+WPluWPtuWtkOiKgueCue+8iOWNs+acgOS9juerr+eahOmCo+S6m++8iQoKICAgICAgdmFyIHVybCA9ICcvc3lzdGVtL2Jhc2ljL3Blcm1pc3MvP3JpZD0nICsgcmlkOwogICAgICBzZWxlY3RlZEtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdXJsICs9ICcmbWlkcz0nICsga2V5OwogICAgICB9KTsKICAgICAgdGhpcy5wdXRSZXF1ZXN0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICBfdGhpczMuYWN0aXZlTmFtZSA9IC0xOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaW5pdFNlbGVjdGVkTWVudXM6IGZ1bmN0aW9uIGluaXRTZWxlY3RlZE1lbnVzKHJpZCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzL21pZHMvIiArIHJpZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICBfdGhpczQuc2VsZWN0ZWRNZW51cyA9IHJlc3A7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBpbml0Um9sZXM6IGZ1bmN0aW9uIGluaXRSb2xlcygpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLmdldFJlcXVlc3QoIi9zeXN0ZW0vYmFzaWMvcGVybWlzcy8iKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIF90aGlzNS5yb2xlcyA9IHJlc3A7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaGFuZ2U6IGZ1bmN0aW9uIGNoYW5nZShyaWQpIHsKICAgICAgYWxlcnQocmlkKTsKCiAgICAgIGlmIChyaWQpIHsKICAgICAgICB0aGlzLmluaXRBbGxNZW51cygpOwogICAgICAgIHRoaXMuaW5pdFNlbGVjdGVkTWVudXMocmlkKTsKICAgICAgfQogICAgfSwKICAgIGluaXRBbGxNZW51czogZnVuY3Rpb24gaW5pdEFsbE1lbnVzKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgiL3N5c3RlbS9iYXNpYy9wZXJtaXNzL21lbnVzIikudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICBfdGhpczYuYWxsTWVudXMgPSByZXNwOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["PermissMana.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"permissManaTools\">\r\n            <el-input placeholder=\"请输入角色英文名\" v-model=\"role.name\" size=\"small\">\r\n                <template slot=\"prepend\">ROLE_</template>\r\n            </el-input>\r\n            <el-input placeholder=\"请输入角色中文名\" v-model=\"role.nameZh\" size=\"small\" @keydown.enter.native=\"addRole\"></el-input>\r\n            <el-button type=\"primary\" size=\"small\" icon=\"el-icon-plus\" @click=\"addRole\">添加角色</el-button>\r\n        </div>\r\n        <div style=\"margin-top: 5px;width:700px\">\r\n            <el-collapse accordion @change=\"change\" v-model=\"activeName\">\r\n                <!--     @change是折叠面板独有的方法，指点到哪个，就加载哪个的数据，传入的参数，默认是他下面子控件的name           -->\r\n                <el-collapse-item :title=\"r.nameZh\" :key=\"index\" v-for=\"(r,index) in roles\" :name=\"r.id\">\r\n                    <el-card class=\"box-card\">\r\n                        <div slot=\"header\" class=\"clearfix\">\r\n                            <span>可访问资源</span>\r\n                            <el-button style=\"float: right; padding: 3px 0;color: red\" type=\"text\" icon=\"el-icon-delete\" @click=\"deleteRole(r)\"></el-button>\r\n                        </div>\r\n                        <div>\r\n                            <el-tree :data=\"allMenus\" :props=\"defaultProps\"\r\n                                     show-checkbox node-key=\"id\" :default-checked-keys=\"selectedMenus\"\r\n                                     ref=\"tree\"\r\n                                     :key=\"index\"></el-tree>\r\n                            <!--  data属性是树形控件底下的数据，props往下找，说不清,show-checkbox显示多选框    -->\r\n                            <!--  默认选中的表示为node-key，这里以数据里面的id为标识，default-checked-keys代表默认选中id为7,8,9的项 -->\r\n                            <!--  ref属性就是给这些树形控件起了个名字，每个角色里面都有一个树形控件，也就是说总共有8个控件，那么这个ref就是一个长度为8的数组,故下面还要传入索引去获取当前的树形控件-->\r\n                            <div style=\"display: flex;justify-content: flex-end\">\r\n                                <el-button size=\"small\" @click=\"cancelUpdate\">取消修改</el-button>\r\n                                <el-button size=\"small\" type=\"primary\" @click=\"doUpdate(r.id,index)\">确认修改</el-button>\r\n                            </div>\r\n                        </div>\r\n                    </el-card>\r\n                </el-collapse-item>\r\n            </el-collapse>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"PermissMana\",\r\n        data() {\r\n            return {\r\n                role: {\r\n                    name: '',\r\n                    nameZh: ''\r\n                },\r\n                roles:[],\r\n                allMenus:[],\r\n                selectedMenus:[],  //权限组打了勾组成的数组\r\n                activeName:-1, //这个值是多少，风琴面板就打开哪个；打开风琴面板时，风琴面板里面的每一个name都会给他赋值\r\n                defaultProps:{\r\n                    children: 'children',\r\n                    label: 'name'\r\n                }\r\n            }\r\n        },\r\n        mounted() {\r\n            this.initRoles();\r\n        },\r\n        methods:{\r\n            deleteRole(r){\r\n                this.$confirm('此操作将永久删除【'+r.nameZh+'】角色, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    this.deleteRequest(\"/system/basic/permiss/?id=\"+r.id).then(resp=>{\r\n                        if (resp){\r\n                            this.initRoles();\r\n                        }\r\n                    })\r\n                }).catch(() => {\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '已取消删除'\r\n                    });\r\n                });\r\n            },\r\n            addRole(){\r\n                if (this.role.name && this.role.nameZh){\r\n                    this.postRequest(\"/system/basic/permiss/role\",this.role).then(resp=>{\r\n                        if (resp){\r\n                            this.role={\r\n                                name : '',\r\n                                nameZh : ''\r\n                            }\r\n                            this.initRoles();\r\n                        }\r\n                    })\r\n                }else{\r\n                   this.$message.error(\"请按规定输入所需要的字段!\");\r\n                }\r\n            },\r\n            cancelUpdate(){\r\n              this.activeName=-1;\r\n            },\r\n            doUpdate(rid,index){\r\n               let tree = this.$refs.tree[index];\r\n               let selectedKeys = tree.getCheckedKeys(true); //getCheckedKeys方法用于获取当前树形控件选中的node-key,传入true的话，即代表只会获取叶子节点（即最低端的那些）\r\n               let url = '/system/basic/permiss/?rid='+rid;\r\n               selectedKeys.forEach(key=>{\r\n                   url+='&mids='+key;\r\n               });\r\n               this.putRequest(url).then(resp=>{\r\n                   if (resp){\r\n                       this.activeName=-1;\r\n                   }\r\n               })\r\n            },\r\n            initSelectedMenus(rid){\r\n                this.getRequest(\"/system/basic/permiss/mids/\"+rid).then(resp=>{\r\n                      if (resp){\r\n                          this.selectedMenus = resp;\r\n                      }\r\n                })\r\n            },\r\n            initRoles(){\r\n                this.getRequest(\"/system/basic/permiss/\").then(resp=>{\r\n                    if (resp){\r\n                        this.roles = resp;\r\n                    }\r\n                })\r\n            },\r\n            change(rid){\r\n               alert(rid);\r\n               if (rid){\r\n                  this.initAllMenus();\r\n                  this.initSelectedMenus(rid);\r\n               }\r\n            },\r\n            initAllMenus(){\r\n                this.getRequest(\"/system/basic/permiss/menus\").then(resp=>{\r\n                    if (resp){\r\n                        this.allMenus=resp;\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n    .permissManaTools {\r\n      display: flex;\r\n    }\r\n\r\n    .permissManaTools .el-input {\r\n      width: 300px;\r\n      margin-right: 5px;\r\n    }\r\n</style>"],"sourceRoot":"src/components/sys/basic"}]}